import { Rule, RuleContext } from "../types";
import { Finding } from "@review-tools/shared";
import { existsSync } from "fs";
import { join } from "path";

export const R014: Rule = {
    id: "R014",
    description: "Checks if the node_modules directory was accidentally committed to the repository",
    category: "repository-hygiene",
    async evaluate(ctx: RuleContext): Promise<Finding[]> {
        const nodeModulesPath = join(ctx.repoPath, "node_modules");
        if (existsSync(nodeModulesPath)) {
            return [{
                ruleId: this.id,
                severity: "high",
                message: "Pasta node_modules versionada.",
                recommendation: "Remova node_modules do reposit√≥rio e utilize .gitignore corretamente.",
                category: this.category
            }];
        }
        return [];
    }
};
